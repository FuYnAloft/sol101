# T01183: 反正切函数的应用

http://cs101.openjudge.cn/practice/01183/

反正切函数可展开成无穷级数，有如下公式

![img](http://media.openjudge.cn/images/1183_1.jpg)(其中0 <= x <= 1) 公式(1)

使用反正切函数计算PI是一种常用的方法。例如，最简单的计算PI的方法：

PI=4arctan(1)=4(1-1/3+1/5-1/7+1/9-1/11+...) 公式(2)

然而，这种方法的效率很低，但我们可以根据角度和的正切函数公式：

tan(a+b)=[tan(a)+tan(b)]/[1-tan(a)*tan(b)] 公式(3)

通过简单的变换得到：

arctan(p)+arctan(q)=arctan[(p+q)/(1-pq)] 公式(4)

利用这个公式，令p=1/2,q=1/3，则(p+q)/(1-pq)=1，有

arctan(1/2)+arctan(1/3)=arctan[(1/2+1/3)/(1-1/2*1/3)]=arctan(1)

使用1/2和1/3的反正切来计算arctan(1)，速度就快多了。
我们将公式(4)写成如下形式

arctan(1/a)=arctan(1/b)+arctan(1/c)

其中a,b和c均为正整数。

我们的问题是：对于每一个给定的a（1 <= a <= 60000），求b＋c的值。我们保证对于任意的a都存在整数解。如果有多个解，要求你给出b+c最小的解。

**输入**

输入文件中只有一个正整数a，其中 1 <= a <= 60000。

**输出**

输出文件中只有一个整数，为 b+c 的值。

样例输入

```
1
```

样例输出

```
5
```

来源

Noi 01




【陈子良 25物理学院】首先进行数学推算。题目要求

$$
\begin{align*}
\arctan\frac{1}{a}&=\arctan\frac{1}{b}+\arctan\frac{1}{c}\\
&=\arctan\frac{b+c}{bc-1}
\end{align*}
$$

即

$$
\begin{align*}
&a(b+c)=bc-1\\&
bc-ab-ac=1
\end{align*}
$$

两边加上$a^2$得

$$
(b-a)(c-a)=a^2+1
$$

可见$b-a$，$c-a$为$a^2+1$的因数。我们要找到$b+c$的最小值，即找到$a^2+1$的两个最接近的因数,再加上$2a$即可。


```python
import math
a=int(input())
m=a**2+1
for x in range(int(math.sqrt(m)),0,-1):
    if m%x==0:
        print(x+m//x+2*a)
        break
```


