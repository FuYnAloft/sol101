# 01042: Gone Fishing

greedy, http://cs101.openjudge.cn/practice/01042/

John is going on a fishing trip. He has h hours available (1 <= h <= 16), and there are n lakes in the area (2 <= n <= 25) all reachable along a single, one-way road. John starts at lake 1, but he can finish at any lake he wants. He can only travel from one lake to the next one, but he does not have to stop at any lake unless he wishes to. For each i = 1,...,n - 1, the number of 5-minute intervals it takes to travel from lake i to lake i + 1 is denoted ti (0 < ti <=192). For example, t3 = 4 means that it takes 20 minutes to travel from lake 3 to lake 4. To help plan his fishing trip, John has gathered some information about the lakes. For each lake i, the number of fish expected to be caught in the initial 5 minutes, denoted fi( fi >= 0 ), is known. Each 5 minutes of fishing decreases the number of fish expected to be caught in the next 5-minute interval by a constant rate of di (di >= 0). If the number of fish expected to be caught in an interval is less than or equal to di , there will be no more fish left in the lake in the next interval. To simplify the planning, John assumes that no one else will be fishing at the lakes to affect the number of fish he expects to catch.
Write a program to help John plan his fishing trip to maximize the number of fish expected to be caught. The number of minutes spent at each lake must be a multiple of 5.

**è¾“å…¥**

You will be given a number of cases in the input. Each case starts with a line containing n. This is followed by a line containing h. Next, there is a line of n integers specifying fi (1 <= i <=n), then a line of n integers di (1 <=i <=n), and finally, a line of n - 1 integers ti (1 <=i <=n - 1). Input is terminated by a case in which n = 0.

**è¾“å‡º**

For each test case, print the number of minutes spent at each lake, separated by commas, for the plan achieving the maximum number of fish expected to be caught (you should print the entire plan on one line even if it exceeds 80 characters). This is followed by a line containing the number of fish expected.
If multiple plans exist, choose the one that spends as long as possible at lake 1, even if no fish are expected to be caught in some intervals. If there is still a tie, choose the one that spends as long as possible at lake 2, and so on. Insert a blank line between cases.

æ ·ä¾‹è¾“å…¥

```
2 
1 
10 1 
2 5 
2 
4 
4 
10 15 20 17 
0 3 4 3 
1 2 3 
4 
4 
10 15 50 30 
0 3 4 3 
1 2 3 
0 
```

æ ·ä¾‹è¾“å‡º

```
45, 5 
Number of fish expected: 31 

240, 0, 0, 0 
Number of fish expected: 480 

115, 10, 50, 35 
Number of fish expected: 724 
```

æ¥æº: East Central North America 1999



```python
# è’‹å­è½©23å·¥å­¦é™¢
from heapq import heappush, heappop
while True:
    n = int(input())
    if n == 0:
        break
    h = int(input()) * 12
    ans = -1 #æœ€å¤§é’“é±¼æ•°é‡
    res = [0] * n #æ¯ä¸ªæ¹–ä¸Šæ‰€èŠ±è´¹çš„æ—¶é—´
    f = list(map(int, input().split()))
    d = list(map(int, input().split()))
    t = [0] + (list(map(int, input().split())) if n > 1 else [])
    #æšä¸¾ç¬¬å‡ ä¸ªæ¹–æ³Šç»“æŸ
    #å¯¹äºæ¯ç§æƒ…å†µè´ªå¿ƒç®—æ³•ï¼Œå®ƒåœ¨æ¯ä¸ªæ¹–ä¸Šéƒ½è¯•å›¾é’“å°½å¯èƒ½å¤šçš„é±¼ï¼Œå¹¶å§‹ç»ˆä¼˜å…ˆè€ƒè™‘é±¼çš„æ•°é‡å¤šçš„æ¹–ã€‚
    for i in range(n):
        now = 0 #è¯¥æƒ…å†µé’“é±¼æ•°é‡
        q = []  #ä¼˜å…ˆé˜Ÿåˆ—
        lakes = [{'id': j, 'f': f[j], 'd': d[j]} for j in range(i + 1)] 
        for lake in lakes:
            # ä½¿å¾—é±¼çš„æ•°é‡å¤šçš„æ¹–æ’åœ¨ä¼˜å…ˆé˜Ÿåˆ—çš„å‰é¢ï¼ˆå–è´Ÿå®ç°ï¼‰ã€‚å¦‚æœé±¼çš„æ•°é‡ç›¸åŒï¼Œé‚£ä¹ˆIDå°çš„æ¹–ä¼šæ’åœ¨å‰é¢ã€‚
            heappush(q, (-lake['f'], lake['id']))
        tmp = [0] * n #è¯¥æƒ…å†µæ¯ä¸ªæ¹–é’“é±¼æ—¶é—´
        time_left = h - sum(t[:i + 1]) #æ¹–ä¸Šå‰©ä½™çš„æ—¶é—´
        while time_left > 0:
            fish_count, idx = heappop(q)
            fish_count = -fish_count #å˜å›æ­£æ•°
            tmp[idx] += 1
            now += fish_count
            lakes[idx]['f'] -= lakes[idx]['d']
            if lakes[idx]['f'] < 0:
                lakes[idx]['f'] = 0
            heappush(q, (-lakes[idx]['f'], idx))
            time_left -= 1
        if now > ans:
            ans = now
            res = tmp.copy()
    print(", ".join(str(val * 5) for val in res))
    print("Number of fish expected:", ans)
    print()
```


**ä¸€æ­¥æ­¥åˆ†æé¢˜æ„ä¸ç®—æ³•é€»è¾‘ï¼Œå¹¶åœ¨ä¿ç•™æ€è·¯çš„åŒæ—¶ä¼˜åŒ–ä¸ç²¾ç‚¼**ã€‚

 ğŸ§© ä¸€ã€é¢˜ç›®é€»è¾‘æ ¸å¿ƒ

John æœ‰ï¼š

- ( n ) ä¸ªæ¹–ï¼›
  
- ( h ) å°æ—¶ï¼ˆå³ ( h Ã— 12 ) ä¸ª 5 åˆ†é’Ÿå•ä½ï¼‰ï¼›
  
- æ¯ä¸ªæ¹–åˆå§‹é±¼æ•° ( f_i )ï¼Œæ¯ 5 åˆ†é’Ÿé±¼é‡å‡å°‘ ( d_i )ï¼›
  
- ç›¸é‚»æ¹–é—´æ—…è¡Œæ—¶é—´ ( t_i )ï¼ˆä»¥ 5 åˆ†é’Ÿä¸ºå•ä½ï¼‰ï¼›
  
- å¯ä»¥åœ¨ä»»æ„ä¸€ä¸ªæ¹–ç»“æŸï¼Œä¸å¿…åˆ°è¾¾æœ€åä¸€ä¸ªã€‚
  

ç›®æ ‡ï¼š

> **è§„åˆ’æ¯ä¸ªæ¹–çš„é’“é±¼æ—¶é—´ï¼Œä½¿æ€»æ•è·é‡æœ€å¤§ã€‚è‹¥æœ‰å¤šç§æ–¹æ¡ˆï¼Œé€‰å‰é¢æ¹–åœå¾—ä¹…çš„æ–¹æ¡ˆã€‚**

---

 ğŸ§® äºŒã€æ€è·¯åˆ†æï¼ˆè´ªå¿ƒ + æšä¸¾ï¼‰

1. **æšä¸¾ç»ˆç‚¹æ¹–**Â `i`ï¼ˆæ„å‘³ç€ä»–ä¼šé’“åˆ°ç¬¬ i ä¸ªæ¹–ä¸ºæ­¢ï¼‰ã€‚
   
    - ç”¨å»çš„æ—…è¡Œæ—¶é—´ï¼š`sum(t[:i+1])`
      
    - å¯ç”¨æ—¶é—´ï¼š`time_left = h - sum(t[:i+1])`
    
2. **åœ¨å‰ i+1 ä¸ªæ¹–ä¸­é’“é±¼**ï¼ˆæŒ‰ä¼˜å…ˆé˜Ÿåˆ—è´ªå¿ƒï¼‰ï¼š
   
    - æ¯æ¬¡æŒ‘é±¼æœ€å¤šçš„æ¹–é’“ä¸€æ¬¡ï¼›
      
    - é’“å®Œæ›´æ–°è¯¥æ¹–é±¼æ•°ï¼›
      
    - é‡å¤ç›´åˆ°æ—¶é—´ç”¨å®Œã€‚
    
3. è®°å½•ï¼š
   
    - æ€»é±¼é‡Â `now`
      
    - æ¯ä¸ªæ¹–é’“é±¼æ¬¡æ•°Â `tmp`
      
    - è‹¥æ€»é±¼é‡æ›´å¤§æˆ–ï¼ˆåŒé±¼é‡ä½†æ›´é å‰æ¹–æ—¶é—´æ›´é•¿ï¼‰â†’ æ›´æ–°ç­”æ¡ˆã€‚
      

---

ğŸ’¡ ä¸‰ã€å…³é”®è´ªå¿ƒç»†èŠ‚

åœ¨æ¯ä¸ªæ—¶é—´æ­¥ï¼š

- é€‰æ‹©å½“å‰Â `f[i]`Â æœ€å¤§çš„æ¹–ï¼›
  
- è‹¥ç›¸åŒï¼Œé€‰æ‹©ç¼–å·æœ€å°ï¼ˆé å‰çš„æ¹–ï¼‰ï¼›
  
- æ¯æ¬¡é’“é±¼åå‡å°‘Â `f[i] -= d[i]`ï¼Œæœ€ä½ä¸º 0ï¼›
  
- ç”¨å †ï¼ˆè´Ÿå€¼æ’åºï¼‰ä¿è¯Â `O(log n)`Â çš„æœ€é«˜é±¼é‡è·å–ã€‚
  

---

âš™ï¸ å››ã€åŸä»£ç åˆ†æä¸ä¼˜åŒ–ç‚¹

ä½ çš„ç‰ˆæœ¬åŠŸèƒ½æ­£ç¡®ï¼Œä»¥ä¸‹å‡ ç‚¹å¯ä¼˜åŒ–ï¼š

|ä¼˜åŒ–ç‚¹|åŸä»£ç é—®é¢˜|ä¼˜åŒ–æ–¹å¼|
|---|---|---|
|å¯è¯»æ€§|æ··ç”¨ dict ä¸åˆ—è¡¨|ç›´æ¥ç”¨åˆ—è¡¨å­˜é±¼é‡å³å¯|
|æ‹·è´|æ¯æ¬¡éƒ½æ–°å»º dict list|ç”¨Â `fcopy = f[:i+1]`Â æ›´å¿«|
|é‡å¤é€»è¾‘|heappush/pop é‡å¤è´Ÿå·å¤„ç†|ç”¨Â `(-f, i)`Â ç»Ÿä¸€è¡¨ç¤º|
|ä»£ç ç»“æ„|å¤šå¤„åµŒå¥—|å¯æŠ½å–ä¸ºå‡½æ•°|

---

âœ… äº”ã€ä¼˜åŒ–åå®Œæ•´ä»£ç 

```python
from heapq import heappush, heappop

while True:
    n = int(input())
    if n == 0:
        break

    h = int(input()) * 12  # è½¬ä¸º5åˆ†é’Ÿå•ä½
    f = list(map(int, input().split()))
    d = list(map(int, input().split()))
    t = [0] + (list(map(int, input().split())) if n > 1 else [])

    best_fish = -1
    best_plan = [0] * n

    # æšä¸¾ç»ˆæ­¢æ¹– i
    for i in range(n):
        travel = sum(t[:i + 1])
        if travel > h:
            break  # æ—¶é—´ä¸å¤Ÿåˆ°è¿™ä¸ªæ¹–

        time_left = h - travel
        cur_f = f[:i + 1]  # å½“å‰é±¼é‡
        time_plan = [0] * n
        total_fish = 0

        # æ„å»ºä¼˜å…ˆé˜Ÿåˆ— (-fish, idx)
        pq = [(-cur_f[j], j) for j in range(i + 1)]
        heap = pq[:]
        import heapq
        heapq.heapify(heap)

        while time_left > 0:
            fish, idx = heappop(heap)
            fish = -fish
            total_fish += fish
            time_plan[idx] += 1

            # é±¼å‡å°‘
            cur_f[idx] = max(0, cur_f[idx] - d[idx])
            heappush(heap, (-cur_f[idx], idx))
            time_left -= 1

        # æ¯”è¾ƒæ›´æ–°æœ€ä¼˜è§£ï¼ˆå…ˆæ¯”è¾ƒé±¼æ•°ï¼Œå†æ¯”è¾ƒæ—¶é—´å­—å…¸åºï¼‰
        if total_fish > best_fish or (total_fish == best_fish and time_plan > best_plan):
            best_fish = total_fish
            best_plan = time_plan[:]

    print(", ".join(str(x * 5) for x in best_plan))
    print("Number of fish expected:", best_fish)
    print()
```

---

å…­ã€æ€§èƒ½ä¸æ­£ç¡®æ€§è¯´æ˜

|æŒ‡æ ‡|åˆ†æ|
|---|---|
|æ—¶é—´å¤æ‚åº¦|O(nÂ² Ã— h) ä½† n â‰¤ 25, h â‰¤ 16Ã—12=192ï¼Œå› æ­¤å¯æ¥å—|
|ç©ºé—´å¤æ‚åº¦|O(n)|
|å¤šè§£åˆ¤å®š|ç”¨å­—å…¸åºæ¯”è¾ƒÂ `time_plan > best_plan`Â å®ç°â€œå‰æ¹–ä¼˜å…ˆâ€è§„åˆ™|
|è¾“å‡ºæ ¼å¼|æ¯æ¹–åˆ†é’Ÿæ•°ç”¨é€—å·éš”å¼€ã€å†è¾“å‡ºæ€»é±¼é‡|


